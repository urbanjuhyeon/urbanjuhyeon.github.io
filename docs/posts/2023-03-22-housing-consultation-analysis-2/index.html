<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-22">
<meta name="description" content="텍스트 정제와 형태소분석을 포함한 텍스트 전처리 과정">

<title>Juhyeon Park - 주거상담기록 데이터 분석 (2): 형태소분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Juhyeon Park</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Juhyeon Park</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jhyeonpark" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">주거상담기록 데이터 분석 (2): 형태소분석</h1>
                  <div>
        <div class="description">
          <p>텍스트 정제와 형태소분석을 포함한 텍스트 전처리 과정</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 22, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#들어가기" id="toc-들어가기" class="nav-link active" data-scroll-target="#들어가기">들어가기</a></li>
  <li><a href="#텍스트-정제" id="toc-텍스트-정제" class="nav-link" data-scroll-target="#텍스트-정제">1. 텍스트 정제</a>
  <ul class="collapse">
  <li><a href="#패키지-설치" id="toc-패키지-설치" class="nav-link" data-scroll-target="#패키지-설치">1.1. 패키지 설치</a></li>
  <li><a href="#패키지-및-데이터-불러오기" id="toc-패키지-및-데이터-불러오기" class="nav-link" data-scroll-target="#패키지-및-데이터-불러오기">1.2. 패키지 및 데이터 불러오기</a></li>
  <li><a href="#불필요한-토큰-제거" id="toc-불필요한-토큰-제거" class="nav-link" data-scroll-target="#불필요한-토큰-제거">1.3. 불필요한 토큰 제거</a></li>
  <li><a href="#동의어-사전" id="toc-동의어-사전" class="nav-link" data-scroll-target="#동의어-사전">1.3. 동의어 사전</a></li>
  </ul></li>
  <li><a href="#텍스트-토큰화" id="toc-텍스트-토큰화" class="nav-link" data-scroll-target="#텍스트-토큰화">2. 텍스트 토큰화</a>
  <ul class="collapse">
  <li><a href="#형태소분석기-kiwi" id="toc-형태소분석기-kiwi" class="nav-link" data-scroll-target="#형태소분석기-kiwi">2.1. 형태소분석기 Kiwi</a>
  <ul class="collapse">
  <li><a href="#기본-설정" id="toc-기본-설정" class="nav-link" data-scroll-target="#기본-설정">기본 설정</a></li>
  <li><a href="#kiwi-추가-설정" id="toc-kiwi-추가-설정" class="nav-link" data-scroll-target="#kiwi-추가-설정">Kiwi 추가 설정</a></li>
  </ul></li>
  <li><a href="#사용자정의-사전" id="toc-사용자정의-사전" class="nav-link" data-scroll-target="#사용자정의-사전">2.2. 사용자정의 사전</a>
  <ul class="collapse">
  <li><a href="#사용자정의사전-소개" id="toc-사용자정의사전-소개" class="nav-link" data-scroll-target="#사용자정의사전-소개">사용자정의사전 소개</a></li>
  <li><a href="#사용자정의사전-구축" id="toc-사용자정의사전-구축" class="nav-link" data-scroll-target="#사용자정의사전-구축">사용자정의사전 구축</a></li>
  </ul></li>
  <li><a href="#불용어-사전" id="toc-불용어-사전" class="nav-link" data-scroll-target="#불용어-사전">2.3. 불용어 사전</a>
  <ul class="collapse">
  <li><a href="#한글자-사전" id="toc-한글자-사전" class="nav-link" data-scroll-target="#한글자-사전">한글자 사전</a></li>
  </ul></li>
  <li><a href="#kiwi-적용하기" id="toc-kiwi-적용하기" class="nav-link" data-scroll-target="#kiwi-적용하기">2.4. Kiwi 적용하기</a>
  <ul class="collapse">
  <li><a href="#kiwi-형태소분석" id="toc-kiwi-형태소분석" class="nav-link" data-scroll-target="#kiwi-형태소분석">Kiwi 형태소분석</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="들어가기" class="level1">
<h1>들어가기</h1>
<p>비정형 텍스트 데이터는 정제와 토큰화 등 <strong>전처리 과정</strong>을 통해 텍스트 분석에 용이한 형태로 바꿔주어야 한다.</p>
<p><img src="image/overview.png" class="img-fluid"></p>
<p><code>정제</code>는 불필요한 텍스트를 제거하고 동의어 사전으로 텍스트를 일관되게 만들어 주는 과정이다. 위 예시에서는 ’서울금융 복지센터’를 ’서울금융복지센터’로 바꾸었다. <code>토큰화</code>는 형태소 분석과 사용자, 불용어 사전 적용으로 분석에 필요한 형태소를 추출하는 과정이다. 띄어쓰기를 기준 토큰 형태로 바꾸었다.</p>
</section>
<section id="텍스트-정제" class="level1">
<h1>1. 텍스트 정제</h1>
<section id="패키지-설치" class="level2">
<h2 class="anchored" data-anchor-id="패키지-설치">1.1. 패키지 설치</h2>
<p>필요한 패키지를 설치한다. 아래 코드를 Visual Studio Code 등 python 편집기에 입력하고 실행하면 된다.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install tqdm</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install kiwipiepy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="image/vscode_pip.png" class="img-fluid"></p>
</section>
<section id="패키지-및-데이터-불러오기" class="level2">
<h2 class="anchored" data-anchor-id="패키지-및-데이터-불러오기">1.2. 패키지 및 데이터 불러오기</h2>
<p>설치 후, 필요한 패키지를 먼저 불러온다.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">## 필요한 모듈 불러오기</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json, random, re, os</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> swifter <span class="co"># 병렬처리</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm <span class="co"># 작업 프로세스 시각화</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> kiwipiepy <span class="im">import</span> Kiwi <span class="co"># 형태소분석기 모듈</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> kiwipiepy.utils <span class="im">import</span> Stopwords <span class="co"># 불용어사전 담겨있는 모듈 불러오기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>샘플 데이터를 불러온다. <a href="data/db_record_v1_sample.csv">여기</a>에서 다운로드 할 수 있다. <code>id_f</code>는 각 데이터 고유 ID, <code>cons_text</code>는 상담기록 원문이다.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>db_record <span class="op">=</span> pd.read_csv(<span class="st">"data/db_record_v1_sample.csv"</span>) <span class="co"># 데이터 불러오기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="3">
<style type="text/css">
</style>

<table id="T_da8be" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_da8be_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">id_f</th>
<th id="T_da8be_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cons_text</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_da8be_row0_col0" class="data row0 col0">1</td>
<td id="T_da8be_row0_col1" class="data row0 col1">* 재개발 임대 아파트 거주중. * 임대료 7개월 1,381,980원 체납 * 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함. * 작년 20.10.30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데, 수급자 신청해 보려 했으나, 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함. * 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니, 이번에 빌려서 어떻게든 해결해 보려 한다고 하심. * 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데, 필요하신지 여쭤보았더니, 자신이 직접 알아보시겠다고 하심.</td>
</tr>
<tr class="even">
<td id="T_da8be_row1_col0" class="data row1 col0">2</td>
<td id="T_da8be_row1_col1" class="data row1 col1">* 청년임차보증금 이자지원사업 추천서 관련 문의전화 주심(20대 추정) * 건강보험자격득실확인서 지역가입자이며 대학생으로 소득 없음. 국세청홈택스 소득금액증명원 조회결과 2019년 아르바이트 소득 조회됨. 취업준비생 유형으로 신청 가능한지 궁금 · 취업준비생 유형으로 신청 가능 * 서울주거포털에서 추천서 신청시 거주지 주소에 현주소 기입하는 것인지 궁금 · 서울주거포털 추천서 신청시 현주소 기입 * 서울시추천서 신청과 이사 할 전월세주택 물색 중에서 어느것을 먼저 해야하는지 궁금 · 서울시추천서 유효기간 발급일로부터 3개월임을 안내</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="불필요한-토큰-제거" class="level2">
<h2 class="anchored" data-anchor-id="불필요한-토큰-제거">1.3. 불필요한 토큰 제거</h2>
<p>기호나 태그 등 불필요한 토큰을 삭제한다. 숫자나 영어도 불필요하다고 여길 수 있지만 ‘1인가구’, ‘2룸’, ‘LH’, ‘SH’ 등 의미있는 토큰이 많아 삭제하지 않았다.</p>
<p>아래 코드로 먼저 텍스트 내 영어 표현을 모두 소문자화 한 후, 한글과 숫자, 영어 외 나머지를 공백 처리했다.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>db_record[<span class="st">'cons_text_cleaned_1'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> text: re.sub(<span class="vs">r"([^가-힣0-9a-z ])"</span>, <span class="st">" "</span>, text), db_record[<span class="st">'cons_text'</span>].<span class="bu">str</span>.lower()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="5">
<style type="text/css">
</style>

<table id="T_2e999" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_2e999_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">cons_text</th>
<th id="T_2e999_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cons_text_cleaned_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_2e999_row0_col0" class="data row0 col0">* 재개발 임대 아파트 거주중. * 임대료 7개월 1,381,980원 체납 * 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함. * 작년 20.10.30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데, 수급자 신청해 보려 했으나, 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함. * 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니, 이번에 빌려서 어떻게든 해결해 보려 한다고 하심. * 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데, 필요하신지 여쭤보았더니, 자신이 직접 알아보시겠다고 하심.</td>
<td id="T_2e999_row0_col1" class="data row0 col1">재개발 임대 아파트 거주중 임대료 7개월 1 381 980원 체납 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함 작년 20 10 30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데 수급자 신청해 보려 했으나 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니 이번에 빌려서 어떻게든 해결해 보려 한다고 하심 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데 필요하신지 여쭤보았더니 자신이 직접 알아보시겠다고 하심</td>
</tr>
<tr class="even">
<td id="T_2e999_row1_col0" class="data row1 col0">* 청년임차보증금 이자지원사업 추천서 관련 문의전화 주심(20대 추정) * 건강보험자격득실확인서 지역가입자이며 대학생으로 소득 없음. 국세청홈택스 소득금액증명원 조회결과 2019년 아르바이트 소득 조회됨. 취업준비생 유형으로 신청 가능한지 궁금 · 취업준비생 유형으로 신청 가능 * 서울주거포털에서 추천서 신청시 거주지 주소에 현주소 기입하는 것인지 궁금 · 서울주거포털 추천서 신청시 현주소 기입 * 서울시추천서 신청과 이사 할 전월세주택 물색 중에서 어느것을 먼저 해야하는지 궁금 · 서울시추천서 유효기간 발급일로부터 3개월임을 안내</td>
<td id="T_2e999_row1_col1" class="data row1 col1">청년임차보증금 이자지원사업 추천서 관련 문의전화 주심 20대 추정 건강보험자격득실확인서 지역가입자이며 대학생으로 소득 없음 국세청홈택스 소득금액증명원 조회결과 2019년 아르바이트 소득 조회됨 취업준비생 유형으로 신청 가능한지 궁금 취업준비생 유형으로 신청 가능 서울주거포털에서 추천서 신청시 거주지 주소에 현주소 기입하는 것인지 궁금 서울주거포털 추천서 신청시 현주소 기입 서울시추천서 신청과 이사 할 전월세주택 물색 중에서 어느것을 먼저 해야하는지 궁금 서울시추천서 유효기간 발급일로부터 3개월임을 안내</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="동의어-사전" class="level2">
<h2 class="anchored" data-anchor-id="동의어-사전">1.3. 동의어 사전</h2>
<p>같은 의미지만 다른 표현으로 쓰이는 단어를 통일하기 위해 동의어 사전을 적용한다. 사전에 구축한 사전은 <a href="data/list_ex_synonyms.csv">여기</a>에서 다운로드 가능하며, 바꿔줄 단어<code>beforeWord</code>, 바꿀 단어<code>afterWord</code>로 구성된다.</p>
<p>예를 들어, 서울주거포털은 ‘서울 주거포털’과 ’서울주거포털’로, ’아산사회복지재단’은 ’현대아산재단’, ‘아산재단’ 등으로 상담사마다 같은 의미지만 다르게 쓰는 표현을 일치시켜준다.</p>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display" data-execution_count="6">
<style type="text/css">
</style>

<table id="T_c7bb0" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_c7bb0_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">beforeWord</th>
<th id="T_c7bb0_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">afterWord</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_c7bb0_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_c7bb0_row0_col0" class="data row0 col0">재개발 임대</td>
<td id="T_c7bb0_row0_col1" class="data row0 col1">재개발임대</td>
</tr>
<tr class="even">
<td id="T_c7bb0_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_c7bb0_row1_col0" class="data row1 col0">재개발임대주택</td>
<td id="T_c7bb0_row1_col1" class="data row1 col1">재개발임대</td>
</tr>
<tr class="odd">
<td id="T_c7bb0_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_c7bb0_row2_col0" class="data row2 col0">서울 주거포털</td>
<td id="T_c7bb0_row2_col1" class="data row2 col1">서울주거포털</td>
</tr>
<tr class="even">
<td id="T_c7bb0_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_c7bb0_row3_col0" class="data row3 col0">현대아산재단&nbsp;</td>
<td id="T_c7bb0_row3_col1" class="data row3 col1">아산사회복지재단</td>
</tr>
<tr class="odd">
<td id="T_c7bb0_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_c7bb0_row4_col0" class="data row4 col0">아산재단</td>
<td id="T_c7bb0_row4_col1" class="data row4 col1">아산사회복지재단</td>
</tr>
<tr class="even">
<td id="T_c7bb0_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_c7bb0_row5_col0" class="data row5 col0">아산사회복지 재단</td>
<td id="T_c7bb0_row5_col1" class="data row5 col1">아산사회복지재단</td>
</tr>
<tr class="odd">
<td id="T_c7bb0_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_c7bb0_row6_col0" class="data row6 col0">아산복지재단</td>
<td id="T_c7bb0_row6_col1" class="data row6 col1">아산사회복지재단</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>동의어 사전으로 상담 원문 내용을 바꾸는 코드는 아래와 같다. 함수 <code>replace_word</code>는 한 개의 상담 내용<code>cons_text</code> 열마다 동의어사전<code>dict_synonyms</code>에서 <code>beforeWord</code>와 일치하는 구간이 발견되면 <code>afterWord</code>로 바꾼다.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## 구축한 동의어사전 불러오기</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dict_synonyms <span class="op">=</span> pd.read_csv(<span class="st">'data/dict/dict_synonyms.csv'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">## 동의어사전을 적용하는 함수 정의</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_word(text):</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dict_synonyms[<span class="st">'beforeWord'</span>])): </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> dict_synonyms[<span class="st">'beforeWord'</span>][i] <span class="kw">in</span> text: <span class="co"># beforeWord가 상담내용에서 발견된다면</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                text <span class="op">=</span> text.replace(dict_synonyms[<span class="st">'beforeWord'</span>][i], dict_synonyms[<span class="st">'afterWord'</span>][i]) <span class="co"># 해당하는 단어의 afterWord로 바꾸어라</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e: <span class="co"># 에러가 있다면 멈추고 알려주어라</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Error 발생 / 에러명: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(dict_synonyms[<span class="st">'afterWord'</span>][i])</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(text)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>db_record[<span class="st">'cons_text_cleaned_2'</span>] <span class="op">=</span> db_record[<span class="st">'cons_text_cleaned_1'</span>].swifter.set_npartitions(npartitions <span class="op">=</span> <span class="dv">12</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: replace_word(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a53ead3749a14171aa08715cc9a62330","version_major":2,"version_minor":0}
</script>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-display" data-execution_count="8">
<style type="text/css">
</style>

<table id="T_23e2a" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_23e2a_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">cons_text</th>
<th id="T_23e2a_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cons_text_cleaned_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_23e2a_row0_col0" class="data row0 col0">* 재개발 임대 아파트 거주중. * 임대료 7개월 1,381,980원 체납 * 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함. * 작년 20.10.30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데, 수급자 신청해 보려 했으나, 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함. * 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니, 이번에 빌려서 어떻게든 해결해 보려 한다고 하심. * 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데, 필요하신지 여쭤보았더니, 자신이 직접 알아보시겠다고 하심.</td>
<td id="T_23e2a_row0_col1" class="data row0 col1">재개발임대 아파트 거주중 임대료 7개월 1 381 980원 체납 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함 작년 20 10 30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데 수급자 신청해 보려 했으나 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니 이번에 빌려서 어떻게든 해결해 보려 한다고 하심 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데 필요하신지 여쭤보았더니 자신이 직접 알아보시겠다고 하심</td>
</tr>
<tr class="even">
<td id="T_23e2a_row1_col0" class="data row1 col0">* 청년임차보증금 이자지원사업 추천서 관련 문의전화 주심(20대 추정) * 건강보험자격득실확인서 지역가입자이며 대학생으로 소득 없음. 국세청홈택스 소득금액증명원 조회결과 2019년 아르바이트 소득 조회됨. 취업준비생 유형으로 신청 가능한지 궁금 · 취업준비생 유형으로 신청 가능 * 서울주거포털에서 추천서 신청시 거주지 주소에 현주소 기입하는 것인지 궁금 · 서울주거포털 추천서 신청시 현주소 기입 * 서울시추천서 신청과 이사 할 전월세주택 물색 중에서 어느것을 먼저 해야하는지 궁금 · 서울시추천서 유효기간 발급일로부터 3개월임을 안내</td>
<td id="T_23e2a_row1_col1" class="data row1 col1">청년임차보증금 이자지원 추천서 관련 문의전화 주심 20대 추정 건강보험자격득실확인서 지역가입자이며 대학생으로 소득 없음 국세청홈택스 소득금액증명원 조회결과 2019년 아르바이트 소득 조회됨 취업준비생 유형으로 신청 가능한지 궁금 취업준비생 유형으로 신청 가능 서울주거포털에서 추천서 신청시 거주지 주소에 현주소 기입하는 것인지 궁금 서울주거포털 추천서 신청시 현주소 기입 서울시추천서 신청과 이사 할 전월세주택물색 중에서 어느것을 먼저 해야하는지 궁금 서울시추천서 유효기간 발급일로부터 3개월임을 안내</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="텍스트-토큰화" class="level1">
<h1>2. 텍스트 토큰화</h1>
<section id="형태소분석기-kiwi" class="level2">
<h2 class="anchored" data-anchor-id="형태소분석기-kiwi">2.1. 형태소분석기 Kiwi</h2>
<p>Kiwi 형태소분석기를 활용하여 텍스트 토큰화를 진행한다. <a href="https://lab.bab2min.pe.kr/kiwi">Kiwi</a>는 빠른 속도와 준수한 정확도, 그리고 사용자사전 수정과 적용이 용이해 형태소분석기로 선택했다.</p>
<section id="기본-설정" class="level3">
<h3 class="anchored" data-anchor-id="기본-설정">기본 설정</h3>
<p><code>Kiwi()</code>에서 설정을 바꿔줄 수 있다. <code>kiwi.tokenize</code>는 텍스트 원문을 형태소분석하는 함수다. 기본 설정으로 예제를 토큰화해보자.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>kiwi <span class="op">=</span> Kiwi() <span class="co"># Kiwi 기본값 설정</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>kiwi.tokenize(<span class="st">"서울주거포털에서 재개발임대 정보를 알아보셰요"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>결과는 토큰 형태로 반환되며, 원형<code>form</code>과 형태소<code>tag</code>, 시작위치<code>start</code>, 길이<code>len</code>으로 구성된다.</p>
<div class="cell" data-execution_count="11">
<div class="cell-output cell-output-stdout">
<pre><code>[Token(form='서울', tag='NNP', start=0, len=2), 
 Token(form='주거', tag='NNG', start=2, len=2), 
 Token(form='포털', tag='NNG', start=4, len=2), 
 Token(form='에서', tag='JKB', start=6, len=2), 
 Token(form='재', tag='XPN', start=9, len=1), 
 Token(form='개발', tag='NNG', start=10, len=2), 
 Token(form='임대', tag='NNG', start=12, len=2), 
 Token(form='장보', tag='NNP', start=15, len=2), 
 Token(form='를', tag='JKO', start=17, len=1), 
 Token(form='알', tag='VV', start=19, len=1), 
 Token(form='어', tag='EC', start=20, len=1), 
 Token(form='보', tag='VX', start=21, len=1), 
 Token(form='세', tag='EC', start=22, len=1), 
 Token(form='요', tag='JX', start=23, len=1)]</code></pre>
</div>
</div>
</section>
<section id="kiwi-추가-설정" class="level3">
<h3 class="anchored" data-anchor-id="kiwi-추가-설정">Kiwi 추가 설정</h3>
<p>Kiwi에서 활용 가능한 설정을 추가한다. <a href="https://bab2min.github.io/kiwipiepy/v0.15.0/kr/">여기</a>에서 설정 사항을 확인할 수 있다. 설정한 예제는 아래와 같다.</p>
<p><img src="image/kiwi_setting.png" class="img-fluid"></p>
<ol type="1">
<li>형태소 분석기에 활용 가능한 모델; 처리 시간은 늘어나지만 정확한 모델링이 가능한 모델로 설정</li>
<li>오타 교정</li>
<li>사용자정의사전 적용; 별도로 만든 txt 파일 활용</li>
<li>불용어사전 적용; Kiwi에서 제공하는 기본 사전 활용</li>
</ol>
</section>
</section>
<section id="사용자정의-사전" class="level2">
<h2 class="anchored" data-anchor-id="사용자정의-사전">2.2. 사용자정의 사전</h2>
<section id="사용자정의사전-소개" class="level3">
<h3 class="anchored" data-anchor-id="사용자정의사전-소개">사용자정의사전 소개</h3>
<p>사용자정의 사전은 별도로 구축한 <strong>사용자정의 단어가 형태소분석기 모델이 아닌 지정한 형태소로 구분</strong>되게끔 하기 위해 사용한다. Kiwi 설정 중 형태소분석기나 불용어사전 등은 기본적으로 제공하는 것을 사용해도 괜찮지만, 이 사용자정의 사전은 분석 목적과 데이터 특성에 맞게 개발하고 업데이트 해줘야 한다.</p>
<p>사용자사전을 적용하지 않고 예제인 ’서울주거포털에서 확인하실 수 있습니다’를 토큰화해보자.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>kiwi <span class="op">=</span> Kiwi(model_type <span class="op">=</span> <span class="st">'sbg'</span>, typos <span class="op">=</span> <span class="st">'basic'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>kiwi.tokenize(<span class="st">'서울주거포털에서 확인하실 수 있습니다'</span>, stopwords <span class="op">=</span> Stopwords())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>결과는 다음과 같다. Kiwi 형태소분석기는 ‘서울주거포털’은 ’서울’, ‘주거’, ’포털’로 각각 명사로 분리하여 결과를 내놓았다. 추후 텍스트 분석의 단위는 이렇게 분리된 토큰인 점을 감안하면, ’서울주거포털’은 이렇게 분리가 되선 안된다.</p>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>[Token(form='서울', tag='NNP', start=0, len=2), 
 Token(form='주거', tag='NNG', start=2, len=2), 
 Token(form='포털', tag='NNG', start=4, len=2), 
 Token(form='확인', tag='NNG', start=9, len=2), 
 Token(form='시', tag='EP', start=12, len=1), 
 Token(form='있', tag='VA', start=16, len=1), 
 Token(form='습니다', tag='EF', start=17, len=3)]</code></pre>
</div>
</div>
<p>여기에서 사용자정의 사전으로 ’서울주거포털’을 하나의 명사로 취급하는 명령어를 <code>add_user_word</code>로 추가해보자.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>kiwi <span class="op">=</span> Kiwi(model_type <span class="op">=</span> <span class="st">'sbg'</span>, typos <span class="op">=</span> <span class="st">'basic'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>kiwi.add_user_word(<span class="st">'서울주거포털'</span>, <span class="st">'NNP'</span>, <span class="dv">0</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>kiwi.tokenize(<span class="st">'서울주거포털에서 확인하실 수 있습니다'</span>, stopwords <span class="op">=</span> Stopwords())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>’서울주거포털’은 분리되지 않고 하나의 고유명사로 구분되었다.</p>
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-stdout">
<pre><code>[Token(form='서울주거포털', tag='NNP', start=0, len=6), 
 Token(form='확인', tag='NNG', start=9, len=2), 
 Token(form='시', tag='EP', start=12, len=1), 
 Token(form='있', tag='VA', start=16, len=1), 
 Token(form='습니다', tag='EF', start=17, len=3)]</code></pre>
</div>
</div>
</section>
<section id="사용자정의사전-구축" class="level3">
<h3 class="anchored" data-anchor-id="사용자정의사전-구축">사용자정의사전 구축</h3>
<p>사용자정의 사전을 구축하는 방법은 다음과 같다.</p>
<section id="동의어-사전-활용하기" class="level4">
<h4 class="anchored" data-anchor-id="동의어-사전-활용하기">동의어 사전 활용하기</h4>
<p>동의어 사전에서 정의한 고유명사를 사용자정의사전 구축에 활용한다. 동의어사전을 불러오고, 치환한 단어의 고유값을 추출한 후, 각 명사를 고유명사<code>NNG</code>와 이 구문이 Kiwi 형태소분석기보다 더 높은 점수를 받게끔 <code>9</code>점을 부여한다.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dict_synonyms <span class="op">=</span> pd.read_csv(<span class="st">'data/dict/dict_synonyms.csv'</span>) <span class="co"># 동의어사전 불러오기</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>list_userDefined_synonyms <span class="op">=</span> (dict_synonyms[<span class="st">'afterWord'</span>].<span class="bu">str</span>.strip().unique() <span class="op">+</span> <span class="st">"</span><span class="ch">\t</span><span class="st">NNG</span><span class="ch">\t</span><span class="st">9"</span>).tolist() <span class="co"># 사용자 정의 사전 포맷으로 변경</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>위 코드 결과는 다음과 같다. 이 사전을 활용하면 ‘서울주거포털’은 ’서울’+‘주거’+‘포털’이 아니라 ’서울주거포털’로, ’일자리센터’는 ’일자리’+’센터’가 아니라 ’일자리센터’로 분석될 것이다.</p>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>서울주거포털  NNG 9
일자리센터   NNG 9
고용복지센터  NNG 9
상담센터    NNG 9</code></pre>
</div>
</div>
</section>
<section id="명사-외-형태소-지정하기" class="level4">
<h4 class="anchored" data-anchor-id="명사-외-형태소-지정하기">명사 외 형태소 지정하기</h4>
<p>동사 등 형태소는 따로 텍스트 파일을 만들어준다. 예를 들어, ‘주심’은 Kiwi 형태소분석기에서는 심판의 의미로 명사로 구분되지만 주거상담 기록에서는 ’서류를 주시다’를 줄여서 쓰는 경우가 많았다. 이 경우에는 ’주심’을 ’주’+‘시’+’다’로 분석되게 지정해야 한다.</p>
<p><a href="data/dict_userDefined_madeByMe.txt">여기</a>에서 다운받은 파일을 먼저 불러온다.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dict_add <span class="op">=</span> pd.read_table(<span class="st">"data/dict/dict_userDefined_madeByMe.txt"</span>) <span class="co"># 추가 사전 불러오기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이 목록을 사용자정의 사전 포맷으로 바꿔준다. 위와 마찬가지로 높은 점수, 우선순위를 가지도록 <code>9</code>점을 가지게 만들어준다.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>list_userDefined_add <span class="op">=</span> (pd.read_table(<span class="st">"data/dict/dict_userDefined_madeByMe.txt"</span>, header <span class="op">=</span> <span class="va">None</span>, sep <span class="op">=</span> <span class="st">"-"</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">"</span><span class="ch">\t</span><span class="st">9"</span>).tolist() <span class="co"># 사용자 정의 사전 포맷으로 변경</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아와 같이 명사 외 형태소는 지정된다.</p>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>주심  주/VV + 시/EP + 다/EC
하셨슴 하/VV + 었/EP + 음/EC  9
연락키로    연락/NNG + 하/XSV + 기/ETN + 로/JKB  9
미납됨 미납/NNG + 되/VV + 다/EC    9</code></pre>
</div>
</div>
</section>
<section id="위-두-사전-결합" class="level4">
<h4 class="anchored" data-anchor-id="위-두-사전-결합">위 두 사전 결합</h4>
<p>위 두 사전을 결합하여 최종 사용자정의 사전을 만들어준다.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dict_userDefined <span class="op">=</span> pd.DataFrame(pd.DataFrame(list_userDefined_synonyms <span class="op">+</span> list_userDefined_add)[<span class="dv">0</span>].unique()) <span class="co"># 두 list 결합</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dict_userDefined.to_csv(<span class="st">'data/dict/dict_userDefined.txt'</span>, index <span class="op">=</span> <span class="va">False</span>, header <span class="op">=</span> <span class="va">False</span>) <span class="co"># 새로운 사용자 정의 사전 저장하기</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="사용자정의사전-적용" class="level4">
<h4 class="anchored" data-anchor-id="사용자정의사전-적용">사용자정의사전 적용</h4>
<p>추가 설정을 한 형태소 분석의 결과는 다음과 같다. <a href="data/dict_userDefined.txt">여기</a>에서 만든 사전은 다운받을 수 있다.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>kiwi <span class="op">=</span> Kiwi(model_type <span class="op">=</span> <span class="st">'sbg'</span>, typos <span class="op">=</span> <span class="st">'basic'</span>) <span class="co"># Kiwi 추가 설정</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>kiwi.load_user_dictionary(<span class="st">'data/dict/dict_userDefined.txt'</span>) <span class="co"># 사용자사전 추가</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>kiwi.tokenize(<span class="st">"서울주거포털을 소개하며 종결키로 함"</span>, stopwords <span class="op">=</span> Stopwords())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>[Token(form='서울주거포털', tag='NNG', start=0, len=6), 
 Token(form='소개', tag='NNG', start=8, len=2), 
 Token(form='종결', tag='NNG', start=13, len=4), 
 Token(form='ᆷ', tag='ETN', start=18, len=1)]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="불용어-사전" class="level2">
<h2 class="anchored" data-anchor-id="불용어-사전">2.3. 불용어 사전</h2>
<p>kiwi 기본 불용어 사전에서 거르지 못한 불용어를 거르기 위해 사전을 만든다. ‘대상자’와 ’서비스’, ‘주거’ 등은 자주 등장하지만 분석에 유의미한 단어는 아니다. 지역명과 상담사명 등도 마찬가지로 제거하면 좋다. 구축한 사전은 <a href="data/dict/dict_stopword.csv">여기</a>에서 다운로드 할 수 있다.</p>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-display" data-execution_count="15">
<style type="text/css">
</style>

<table id="T_558fc" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_558fc_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">type</th>
<th id="T_558fc_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">word</th>
<th id="T_558fc_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">pos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_558fc_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_558fc_row0_col0" class="data row0 col0">일반</td>
<td id="T_558fc_row0_col1" class="data row0 col1">대상자</td>
<td id="T_558fc_row0_col2" class="data row0 col2">NNG</td>
</tr>
<tr class="even">
<td id="T_558fc_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_558fc_row1_col0" class="data row1 col0">일반</td>
<td id="T_558fc_row1_col1" class="data row1 col1">서비스</td>
<td id="T_558fc_row1_col2" class="data row1 col2">NNG</td>
</tr>
<tr class="odd">
<td id="T_558fc_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_558fc_row2_col0" class="data row2 col0">일반</td>
<td id="T_558fc_row2_col1" class="data row2 col1">주거</td>
<td id="T_558fc_row2_col2" class="data row2 col2">NNG</td>
</tr>
<tr class="even">
<td id="T_558fc_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_558fc_row3_col0" class="data row3 col0">일반</td>
<td id="T_558fc_row3_col1" class="data row3 col1">주택</td>
<td id="T_558fc_row3_col2" class="data row3 col2">NNG</td>
</tr>
<tr class="odd">
<td id="T_558fc_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_558fc_row4_col0" class="data row4 col0">일반</td>
<td id="T_558fc_row4_col1" class="data row4 col1">가구</td>
<td id="T_558fc_row4_col2" class="data row4 col2">NNG</td>
</tr>
<tr class="even">
<td id="T_558fc_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_558fc_row5_col0" class="data row5 col0">지역명</td>
<td id="T_558fc_row5_col1" class="data row5 col1">잠실2동</td>
<td id="T_558fc_row5_col2" class="data row5 col2">NNG</td>
</tr>
<tr class="odd">
<td id="T_558fc_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_558fc_row6_col0" class="data row6 col0">지역명</td>
<td id="T_558fc_row6_col1" class="data row6 col1">잠실3동</td>
<td id="T_558fc_row6_col2" class="data row6 col2">NNG</td>
</tr>
<tr class="even">
<td id="T_558fc_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_558fc_row7_col0" class="data row7 col0">상담사명</td>
<td id="T_558fc_row7_col1" class="data row7 col1">박상준</td>
<td id="T_558fc_row7_col2" class="data row7 col2">NNG</td>
</tr>
<tr class="odd">
<td id="T_558fc_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_558fc_row8_col0" class="data row8 col0">상담사명</td>
<td id="T_558fc_row8_col1" class="data row8 col1">이종현</td>
<td id="T_558fc_row8_col2" class="data row8 col2">NNG</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="한글자-사전" class="level3">
<h3 class="anchored" data-anchor-id="한글자-사전">한글자 사전</h3>
<p>단어가 한글자지만 중요한 것을 모아둔 사전이다. 보통 한글자는 의미가 잘 없다. 하지만 ‘돈’은 경제적 상황을 서술할 때 사용하며, ’좁’은 ’좁다’, ‘좁은 집’으로, ’낡’은 ’낡다’ 등으로 활용된다. 이 같은 중요한 한글자는 불용어로 걸러지지 않게끔 한다. 형태소 분석한 토큰이 아주 짧은 경우는 보통 제거한다. <a href="data/dict/dict_oneChar.csv">여기</a>에서 다운로드 할 수 있다.</p>
<div class="cell" data-execution_count="25">
<div class="cell-output cell-output-display" data-execution_count="16">
<style type="text/css">
</style>

<table id="T_9426a" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_9426a_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">word</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9426a_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_9426a_row0_col0" class="data row0 col0">돈</td>
</tr>
<tr class="even">
<td id="T_9426a_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_9426a_row1_col0" class="data row1 col0">좁</td>
</tr>
<tr class="odd">
<td id="T_9426a_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_9426a_row2_col0" class="data row2 col0">낡</td>
</tr>
<tr class="even">
<td id="T_9426a_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_9426a_row3_col0" class="data row3 col0">커</td>
</tr>
<tr class="odd">
<td id="T_9426a_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_9426a_row4_col0" class="data row4 col0">크</td>
</tr>
<tr class="even">
<td id="T_9426a_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_9426a_row5_col0" class="data row5 col0">작</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="kiwi-적용하기" class="level2">
<h2 class="anchored" data-anchor-id="kiwi-적용하기">2.4. Kiwi 적용하기</h2>
<p>앞에서 소개한 내용을 종합하여 만든 형태소 분석은 아래와 같다.</p>
<section id="kiwi-형태소분석" class="level3">
<h3 class="anchored" data-anchor-id="kiwi-형태소분석">Kiwi 형태소분석</h3>
<p>Kiwi 추가 설정과 사용자정의사전을 추가해서 예제 파일을 형태소분석 해준다.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>kiwi <span class="op">=</span> Kiwi(model_type <span class="op">=</span> <span class="st">'sbg'</span>, typos <span class="op">=</span> <span class="st">'basic'</span>) <span class="co"># Kiwi 추가 설정</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>kiwi.load_user_dictionary(<span class="st">'data/dict/dict_userDefined.txt'</span>) <span class="co"># 사용자사전 추가</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>morph_analysis <span class="op">=</span> <span class="kw">lambda</span> x: kiwi.tokenize(x, stopwords <span class="op">=</span> Stopwords()) <span class="cf">if</span> <span class="bu">type</span>(x) <span class="kw">is</span> <span class="bu">str</span> <span class="cf">else</span> <span class="va">None</span> <span class="co"># 형태소 분석</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>db_record[<span class="st">'cons_text_posTagged_kiwi'</span>] <span class="op">=</span> db_record[<span class="st">'cons_text_cleaned_2'</span>].swifter.<span class="bu">apply</span>(morph_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"10da4101255c4575852fcd3827c6566f","version_major":2,"version_minor":0}
</script>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-display" data-execution_count="18">
<style type="text/css">
</style>

<table id="T_ff9c5" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_ff9c5_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">cons_text</th>
<th id="T_ff9c5_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cons_text_posTagged_kiwi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_ff9c5_row0_col0" class="data row0 col0">* 재개발 임대 아파트 거주중. * 임대료 7개월 1,381,980원 체납 * 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함. * 작년 20.10.30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데, 수급자 신청해 보려 했으나, 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함. * 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니, 이번에 빌려서 어떻게든 해결해 보려 한다고 하심. * 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데, 필요하신지 여쭤보았더니, 자신이 직접 알아보시겠다고 하심.</td>
<td id="T_ff9c5_row0_col1" class="data row0 col1">[Token(form='재개발임대', tag='NNG', start=2, len=5), Token(form='아파트', tag='NNG', start=8, len=3), Token(form='거주', tag='NNG', start=12, len=3), Token(form='임대료', tag='NNG', start=19, len=3), Token(form='7', tag='SN', start=23, len=1), Token(form='개월', tag='NNB', start=24, len=2), Token(form='1', tag='SN', start=27, len=1), Token(form='381', tag='SN', start=29, len=3), Token(form='980', tag='SN', start=33, len=3), Token(form='체납', tag='NNG', start=38, len=2), Token(form='일자리', tag='NNG', start=43, len=3), Token(form='구하', tag='VV', start=48, len=2), Token(form='중', tag='NNG', start=52, len=1), Token(form='수입', tag='NNG', start=56, len=2), Token(form='경제', tag='NNG', start=63, len=2), Token(form='어렵', tag='VA-I', start=69, len=3), Token(form='상황', tag='NNG', start=73, len=2), Token(form='인하', tag='VV', start=78, len=2), Token(form='ᆷ', tag='ETM', start=79, len=1), Token(form='작년', tag='NNG', start=84, len=2), Token(form='20', tag='SN', start=87, len=2), Token(form='10', tag='SN', start=90, len=2), Token(form='30', tag='SN', start=93, len=2), Token(form='체납', tag='NNG', start=96, len=2), Token(form='상담', tag='NNG', start=99, len=2), Token(form='대상자', tag='NNG', start=104, len=3), Token(form='현재', tag='MAG', start=109, len=2), Token(form='실업급여', tag='NNG', start=112, len=4), Token(form='180', tag='SN', start=118, len=3), Token(form='나오', tag='VV', start=125, len=2), Token(form='데', tag='NNB', start=131, len=1), Token(form='수급자', tag='NNG', start=134, len=3), Token(form='신청', tag='NNG', start=138, len=2), Token(form='보', tag='VX', start=142, len=1), Token(form='려', tag='EC', start=143, len=1), Token(form='으나', tag='EC', start=146, len=2), Token(form='실업급여', tag='NNG', start=150, len=4), Token(form='중복', tag='NNG', start=156, len=2), Token(form='받', tag='VV-R', start=161, len=1), Token(form='안내', tag='NNG', start=170, len=2), Token(form='받', tag='VV-R', start=174, len=1), Token(form='함', tag='NNP', start=178, len=1), Token(form='임대료', tag='NNG', start=184, len=3), Token(form='체납', tag='NNG', start=188, len=2), Token(form='기간', tag='NNG', start=191, len=2), Token(form='길어지', tag='VV', start=195, len=3), Token(form='ᆯ수록', tag='EC', start=197, len=3), Token(form='나중', tag='NNG', start=201, len=2), Token(form='퇴거', tag='NNG', start=205, len=2), Token(form='명령', tag='NNG', start=208, len=2), Token(form='받', tag='VV-R', start=212, len=1), Token(form='으시', tag='EP', start=213, len=2), Token(form='있', tag='VA', start=219, len=1), Token(form='안내', tag='NNG', start=223, len=2), Token(form='드리', tag='VV', start=225, len=2), Token(form='더니', tag='EC', start=227, len=2), Token(form='이번', tag='NNG', start=231, len=2), Token(form='빌리', tag='VV', start=235, len=2), Token(form='어떻게', tag='MAG', start=239, len=3), Token(form='든', tag='JX', start=242, len=1), Token(form='해결', tag='NNG', start=244, len=2), Token(form='보', tag='VX', start=248, len=1), Token(form='려', tag='EC', start=249, len=1), Token(form='ᆫ다고', tag='EC', start=251, len=3), Token(form='시', tag='EP', start=255, len=2), Token(form='일자리', tag='NNG', start=263, len=3), Token(form='구하', tag='VV', start=268, len=2), Token(form='시', tag='EP', start=270, len=1), Token(form='ᆫ다고', tag='EC', start=270, len=3), Token(form='시', tag='EP', start=275, len=1), Token(form='임대주택', tag='NNG', start=278, len=4), Token(form='입주자', tag='NNG', start=283, len=3), Token(form='분', tag='NNB', start=287, len=1), Token(form='께', tag='JKB', start=289, len=1), Token(form='일자리', tag='NNG', start=291, len=3), Token(form='상담', tag='NNG', start=295, len=2), Token(form='연계', tag='NNG', start=298, len=2), Token(form='드리', tag='VX', start=302, len=2), Token(form='데', tag='NNB', start=308, len=1), Token(form='필요', tag='NNG', start=311, len=2), Token(form='시', tag='EP', start=314, len=1), Token(form='ᆫ지', tag='EC', start=314, len=2), Token(form='여쭈', tag='VV', start=317, len=2), Token(form='보', tag='VX', start=319, len=1), Token(form='더니', tag='EC', start=321, len=2), Token(form='자신', tag='NNG', start=325, len=2), Token(form='직접', tag='MAG', start=329, len=2), Token(form='알아보', tag='VV', start=332, len=3), Token(form='시', tag='EP', start=335, len=1), Token(form='시', tag='EP', start=340, len=2)]</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>형태소분석 한 결과를 이어준다. ‘Token(form=’서울주거포털’, tag=‘NNG’, start=0, len=6)’는 그대로 활용할 수 없으므로, Token의 form들을 <code>append</code>로 이어준다. 이어줄 때, 주요품사만 골라서 붙여준다.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## 형태소분석된 것들을 join</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dict_stopword <span class="op">=</span> pd.read_csv(<span class="st">'data/dict/dict_stopword.csv'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>dict_oneChar <span class="op">=</span> pd.read_csv(<span class="st">"data/dict/dict_oneChar.csv"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 품사 정의하기</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>list_pos_all <span class="op">=</span> (<span class="st">"N"</span>, <span class="st">"V"</span>, <span class="st">"M"</span>, <span class="st">"J"</span>, <span class="st">"E"</span>, <span class="st">"X"</span>) <span class="co"># 주요 품사 모두</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>list_pos_main <span class="op">=</span> (<span class="st">"N"</span>, <span class="st">"V"</span>) <span class="co"># 명사, 동사, 형용사만</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 불용어 제거하고 형태소 결합하기</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenToText(tokens):</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    textJoinedMain <span class="op">=</span> []</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    textJoinedAll <span class="op">=</span> [] </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> token, pos, _, _ <span class="kw">in</span> tokens:        </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (token <span class="kw">not</span> <span class="kw">in</span> <span class="bu">list</span>(dict_stopword[<span class="st">'word'</span>]) <span class="kw">and</span> ( <span class="bu">len</span>(token) <span class="op">&gt;</span> <span class="dv">1</span> <span class="kw">or</span> (<span class="bu">len</span>(token) <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> token <span class="kw">in</span> <span class="bu">list</span>(dict_oneChar[<span class="st">'word'</span>]) ) )): </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pos.startswith(<span class="st">'V'</span>): token <span class="op">=</span> token <span class="op">+</span> <span class="st">'다'</span> <span class="co"># 동사라면 뒤에 '다'를 붙여서 자연스럽게 만들기</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pos.startswith(list_pos_main) : textJoinedMain.append(token)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pos.startswith(list_pos_all) : textJoinedAll.append(token)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> pd.Series([<span class="st">' '</span>.join(textJoinedAll), <span class="st">' '</span>.join(textJoinedMain)])</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> out</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>db_record[[<span class="st">'cons_text_posTagged_all'</span>, <span class="st">'cons_text_posTagged_main'</span>]] <span class="op">=</span> db_record[<span class="st">'cons_text_posTagged_kiwi'</span>].swifter.set_npartitions(npartitions <span class="op">=</span> <span class="dv">6</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: tokenToText(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a585e6721d9b4fa0be0a8581f612eaa1","version_major":2,"version_minor":0}
</script>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="20">
<style type="text/css">
</style>

<table id="T_9371a" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_9371a_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">cons_text</th>
<th id="T_9371a_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cons_text_posTagged_main</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9371a_row0_col0" class="data row0 col0">* 재개발 임대 아파트 거주중. * 임대료 7개월 1,381,980원 체납 * 일자리를 구하는 중으로 수입이 없어 경제적으로 어려운 상황으로 인함. * 작년 20.10.30 체납 상담했던 대상자로 현재 실업급여로 180만원이 나오고 있는데, 수급자 신청해 보려 했으나, 실업급여와 중복으로 받을 수 없다고 안내를 받았다 함. * 임대료 체납 기간이 길어질수록 나중에 퇴거 명령을 받으실 수도 있다고 안내드렸더니, 이번에 빌려서 어떻게든 해결해 보려 한다고 하심. * 일자리를 구하신다고 하셔서 임대주택 입주자 분들께 일자리 상담 연계해 드리고 있는데, 필요하신지 여쭤보았더니, 자신이 직접 알아보시겠다고 하심.</td>
<td id="T_9371a_row0_col1" class="data row0 col1">재개발임대 아파트 거주 임대료 체납 일자리 구하다 수입 경제 어렵다 상황 인하다 작년 체납 상담 실업급여 나오다 수급자 신청 실업급여 중복 안내 임대료 체납 기간 길어지다 나중 퇴거 명령 안내 드리다 빌리다 해결 일자리 구하다 임대주택 입주자 일자리 상담 연계 드리다 필요 여쭈다 알아보다</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"0003694c3144417796940482e4b20493":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"037b282d2319492bba79389332c590a5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10722440ad3d45fc9292bf869ef5037a":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_dd5774d5e6964303bd4a3eef5cbadc87","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_baf6e24fc3d949bc8ca3eca3da85471f","tabbable":null,"tooltip":null,"value":100}},"10da4101255c4575852fcd3827c6566f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_57f849a9f24f43b2baff2296086e8725","IPY_MODEL_2ecb626316f1428698f9c6e65f61e818","IPY_MODEL_cb1fefdcb66445f2a61d0de70275e6bb"],"layout":"IPY_MODEL_91ea842e91bc4d6d90410e07952738a5","tabbable":null,"tooltip":null}},"2ecb626316f1428698f9c6e65f61e818":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_63767859ef514188b19816889d5c9c0d","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0003694c3144417796940482e4b20493","tabbable":null,"tooltip":null,"value":100}},"311954233de2407ba74d4c1ca7a9290f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4d701108f2104530baf8a7671a5dbd85":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"57f849a9f24f43b2baff2296086e8725":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_60a7730a7756413eb64f6c529281f530","placeholder":"​","style":"IPY_MODEL_d07cdb19c3254794bf2fefdff638658b","tabbable":null,"tooltip":null,"value":"Pandas Apply: 100%"}},"5dccb253775841bea04ec0e7c0bb7215":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_ca86210dcf1a49a78d8714b56085c38f","placeholder":"​","style":"IPY_MODEL_d7f07e197e394ea89d4cdfb829e97755","tabbable":null,"tooltip":null,"value":" 100/100 [00:00&lt;00:00, 520.89it/s]"}},"60a7730a7756413eb64f6c529281f530":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63478aa97ec7417d91f829b7f9054d62":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63767859ef514188b19816889d5c9c0d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"71f256fbbe5a4393a327f5c442c94ab8":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_311954233de2407ba74d4c1ca7a9290f","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ba5c45a4f8914cfdaa52cd685bd3a883","tabbable":null,"tooltip":null,"value":100}},"785befd7dd814bb186250ab805329270":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8abc4bec03e74c139b73350aab72c945":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_c71bd04561a649dcba536733469d60c5","placeholder":"​","style":"IPY_MODEL_be943e53d65d4499808bc7a22b27670d","tabbable":null,"tooltip":null,"value":" 100/100 [00:00&lt;00:00, 210.42it/s]"}},"91ea842e91bc4d6d90410e07952738a5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a53ead3749a14171aa08715cc9a62330":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cce259ab046148adaefbd1a9ed1919e9","IPY_MODEL_10722440ad3d45fc9292bf869ef5037a","IPY_MODEL_5dccb253775841bea04ec0e7c0bb7215"],"layout":"IPY_MODEL_63478aa97ec7417d91f829b7f9054d62","tabbable":null,"tooltip":null}},"a585e6721d9b4fa0be0a8581f612eaa1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d7823fa9d2d74541ad9699e4ee61035c","IPY_MODEL_71f256fbbe5a4393a327f5c442c94ab8","IPY_MODEL_8abc4bec03e74c139b73350aab72c945"],"layout":"IPY_MODEL_c98192f5c0b341adbbd9fd1810eb3f28","tabbable":null,"tooltip":null}},"a5dc6086218640759572d8fa6dc2076b":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ba5c45a4f8914cfdaa52cd685bd3a883":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"baf6e24fc3d949bc8ca3eca3da85471f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"be943e53d65d4499808bc7a22b27670d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"c71bd04561a649dcba536733469d60c5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c98192f5c0b341adbbd9fd1810eb3f28":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ca86210dcf1a49a78d8714b56085c38f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb1fefdcb66445f2a61d0de70275e6bb":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_a5dc6086218640759572d8fa6dc2076b","placeholder":"​","style":"IPY_MODEL_e35bcbee45464b61b3d9944216619edc","tabbable":null,"tooltip":null,"value":" 100/100 [00:00&lt;00:00, 131.09it/s]"}},"cce259ab046148adaefbd1a9ed1919e9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_785befd7dd814bb186250ab805329270","placeholder":"​","style":"IPY_MODEL_4d701108f2104530baf8a7671a5dbd85","tabbable":null,"tooltip":null,"value":"Pandas Apply: 100%"}},"d07cdb19c3254794bf2fefdff638658b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"d7823fa9d2d74541ad9699e4ee61035c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_037b282d2319492bba79389332c590a5","placeholder":"​","style":"IPY_MODEL_fced2104fb5f47a488655f16aaf044c9","tabbable":null,"tooltip":null,"value":"Pandas Apply: 100%"}},"d7f07e197e394ea89d4cdfb829e97755":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"dd5774d5e6964303bd4a3eef5cbadc87":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e35bcbee45464b61b3d9944216619edc":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"fced2104fb5f47a488655f16aaf044c9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}}},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>